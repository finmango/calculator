<!DOCTYPE html><html><!-- HTML head --><head>
    <!-- HTML metadata -->
    <meta charset="UTF-8">
    <title>FinMango Stock Portfolio 📈 Simulator</title>
    <meta name="description" content="Stock portfolio simulator, made by FinMango">
    <link rel="icon" type="image/ico" href="../../../static/favicon.ico">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FinMango Stock Portfolio 📈 Simulator">

    <!-- Homescreen icons -->
    <link rel="apple-touch-icon" href="../../../static/favicon.ico">

    <!-- Capabilities-related metadata -->
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <!-- VueJS -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <!-- Comment the previous line and uncomment this one to enable debug more for VueJS -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script> -->

    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <!-- MomentJS -->
    <script type="text/javascript" src="../../../third_party/moment/min/moment.min.js"></script>

    <!-- Custom styles and fonts -->
    <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/goldman-sans">
    <link rel="stylesheet" href="../../../third_party/picnic/picnic.min.css">
    <link rel="stylesheet" href="../../../static/styles.min.css">

    <!-- Polyfills, custom functions and constants -->
    <script type="text/javascript" src="../../../static/formatter.min.js"></script>
    <script type="text/javascript" src="../../../static/data-helper.min.js"></script>
    <script type="text/javascript" src="../../../static/polyfills.min.js"></script>
    <script type="text/javascript">const DEFAULT_OPTIONS={font:"Goldman Sans",chart_legend_position:"none",chart_padding_top:24,chart_padding_left:64,chart_padding_right:0,chart_padding_bottom:48};CURRENT_OPTIONS=Object.keys(DEFAULT_OPTIONS).reduce((t,o)=>Object.assign(t,{[o]:sessionStorage.getItem(o)||DEFAULT_OPTIONS[o]}),{}),GOOGLE_CHARTS_CONFIG=window.GOOGLE_CHARTS_CONFIG||{theme:"material",fontName:CURRENT_OPTIONS.font,titleTextStyle:{fontName:CURRENT_OPTIONS.font},backgroundColor:"#FCFCFC",colors:["#FB780F"],legend:{position:CURRENT_OPTIONS.chart_legend_position},chartArea:{width:"100%",height:"100%",top:parseInt(CURRENT_OPTIONS.chart_padding_top||24),left:parseInt(CURRENT_OPTIONS.chart_padding_left||64),right:parseInt(CURRENT_OPTIONS.chart_padding_right||0),bottom:parseInt(CURRENT_OPTIONS.chart_padding_bottom||48),backgroundColor:"#FCFCFC"},titlePosition:"in",axisTitlesPosition:"in",hAxis:{textPosition:"bottom",textStyle:{fontName:CURRENT_OPTIONS.font}},vAxis:{textPosition:"out",viewWindow:{min:0},textStyle:{fontName:CURRENT_OPTIONS.font}},height:parseInt(CURRENT_OPTIONS.chart_height||300)};</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-B3RYND2Z48"></script>
<script async>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B3RYND2Z48");</script>


<!-- Load analytics at the end of the head element before the body -->


</head><body>
    <!-- Page header-->
    <header class="flex center one">
    <div>
        <a class="centered uppercase" target="_blank" href="https://finmango.org" style="display: block; padding: 0;">
            <img class="centered" src="../../../static/logo.png" height="64" width="auto">
        </a>
    </div>
</header>

    <!-- Main element -->
    <main class="single-column-wide" style="margin-top: auto; margin-bottom: auto;">
        <div>
    <!-- Import CSV parser -->
    <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>

    <div id="portfolio-calculator-data">

        <div class="modal">
            <input id="symbols-modal" type="checkbox">
            <label for="symbols-modal" class="overlay"></label>
            <article>
                <header>
                    <h3>Symbol Information</h3>
                    <label for="symbols-modal" class="close">×</label>
                </header>
                <section class="content">
                    <table>
                        <tbody><tr style="display: none;">
                            <th>Symbol</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>CASH</td>
                            <td>Cash allocation in U.S. dollars</td>
                        </tr>
                        <tr>
                            <td>SPY</td>
                            <td>
                                <a href="https://www.ssga.com/us/en/institutional/etfs/funds/spdr-sp-500-etf-trust-spy" target="_blank">
                                    SPDR S&amp;P 500 ETF Trust
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>TLT</td>
                            <td>
                                <a href="https://www.ishares.com/us/products/239454/TLT" target="_blank">
                                    iShares 20+ Year Treasury Bond ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>VTI</td>
                            <td>
                                <a href="https://investor.vanguard.com/etf/profile/VTI" target="_blank">
                                    Vanguard Total Stock Market ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>VXUS</td>
                            <td>
                                <a href="https://investor.vanguard.com/etf/profile/VXUS" target="_blank">
                                    Vanguard Total International Stock ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>VB</td>
                            <td>
                                <a href="https://investor.vanguard.com/etf/profile/VB" target="_blank">
                                    Vanguard Small-Cap ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>VBR</td>
                            <td>
                                <a href="https://investor.vanguard.com/etf/profile/VBR" target="_blank">
                                    Vanguard Small-Cap Value ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>BND</td>
                            <td>
                                <a href="https://investor.vanguard.com/etf/profile/BND" target="_blank">
                                    Vanguard Total Bond Market ETF
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>UPRO</td>
                            <td>
                                <a href="https://www.proshares.com/our-etfs/leveraged-and-inverse/upro" target="_blank">
                                    ProShares UltraPro S&amp;P500
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>TMF</td>
                            <td>
                                <a href="https://www.direxion.com/product/daily-20-year-treasury-bull-bear-3x-etfs" target="_blank">
                                    Direxion Daily 20+ Year Treasury Bull
                                </a>
                            </td>
                        </tr>
                    </tbody></table>
                </section>
            </article>
            <footer></footer>
        </div>

        <div>
            <h2 v-if="error_message" class="centered" style="text-transform: uppercase;">{{error_message}}</h2>
            <div :class="{invisible: error_message !== null}">
                <h2 class="centered" style="text-transform: uppercase;">
                    You earned {{ Formatter.price(initial_investment * performance.returns_minus_dca) }}
                    in investment profits
                </h2>
                <p style="text-align: justify;">
                    You started with <b class="green">{{ Formatter.price(initial_investment) }}</b> on
                    <b>{{ performance.start_date?.toLocaleDateString() }}</b>. You invested an additional
                    <b class="green">{{ Formatter.price(dca_amount * performance.dca_count) }}</b> afer
                    <b>{{ performance.dca_count }}</b> contribution(s) via the selected dollar-cost
                    averaging strategy, so your total investment was
                    <b class="green">{{ Formatter.price(total_invested) }}</b>.
                    Your investment portfolio balance was
                    <b :class="[performance.returns > 0 ? 'green' : 'red']">
                        {{ Formatter.price(final_balance) }}</b> on
                    <b>{{ performance.end_date?.toLocaleDateString() }}</b>. The
                    portfolio was rebalanced <b>{{ performance.rebalance_count }}</b> time(s).
                </p>
            </div>
        </div>

        <div class="flex one two-600">

            <div class="fourth" style="padding-top: 24px">
                <label for="target_allocations">Target Allocations</label>
                <div id="target_allocations">
                    <div v-for="symbol in symbols">
                        <label for="{{ symbol }}">
                            <small>{{ allocations_percent[symbol] }}% {{ symbol }}</small>
                        </label>
                        <input @input="temp()" type="range" v-model.number="allocations_percent[symbol]" min="0" max="100" step="5" style="margin-top: -10px; padding: 0;">
                    </div>
                </div>
                <label for="symbols-modal">ℹ️ What's this?</label>
            </div>

            <div class="three-fourth">
                <!-- Element host for the Google Charts -->
                <div :class="{invisible: error_message !== null}" id="perf-chart-container" class="chart-container">
                </div>
                <div :class="{invisible: error_message !== null}" id="drawdown-chart-container" class="chart-container">
                </div>
            </div>

        </div>

        <!-- Summary simulation statistics -->
        <div class="flex one" style="overflow-x: auto;">
            <table :class="{invisible: error_message !== null}" style="font-size: small;">
                <tbody><tr>
                    <th>Period Duration*</th>
                    <th>Average Annualized Return</th>
                    <th>Largest Annualized Return</th>
                    <th>Smallest Annualized Return</th>
                    <th>Average Max Drawdown</th>
                    <th>Largest Max Drawdown</th>
                    <th>Smallest Max Drawdown</th>
                </tr>
                <tr v-show="'1 Year' in performance">
                    <td>1 Year</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.ret_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.ret_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.ret_min, true) }}</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.drw_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.drw_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['1 Year']?.drw_min, true) }}</td>
                </tr>
                <tr v-show="'5 Year' in performance">
                    <td>5 Years</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.ret_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.ret_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.ret_min, true) }}</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.drw_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.drw_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['5 Year']?.drw_min, true) }}</td>
                </tr>
                <tr v-show="'10 Year' in performance">
                    <td>10 Years</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.ret_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.ret_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.ret_min, true) }}</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.drw_avg, true) }}</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.drw_max, true) }}</td>
                    <td>{{ Formatter.percent(performance['10 Year']?.drw_min, true) }}</td>
                </tr>
                <tr>
                    <td>Full Simulation</td>
                    <td>{{ Formatter.percent(performance.returns_annualized, true) }}</td>
                    <td>{{ Formatter.percent(performance.returns_annualized, true) }}</td>
                    <td>{{ Formatter.percent(performance.returns_annualized, true) }}</td>
                    <td>{{ Formatter.percent(performance.max_drawdown, true) }}</td>
                    <td>{{ Formatter.percent(performance.max_drawdown, true) }}</td>
                    <td>{{ Formatter.percent(performance.max_drawdown, true) }}</td>
                </tr>
            </tbody></table>
            <small style="margin-top: 8px">
                *The period statistics are computed using a
                <a href="https://en.wikipedia.org/wiki/Moving_average">moving average</a>, minimum, and maximum of the
                simulated portfolio returns. For example, "5 Years" includes data for all 5-year periods starting at the
                first day of the simulation.
            </small>
        </div>

        <div class="spacer"></div>

        <details>
            <summary style="display: list-item">Adjust Calculator Options</summary>

            <form class="flex one two-600">
                <div>
    <label for="initial_investment">
        Initial Investment
        <small>Amount of cash used for the initial allocation of the portfolio.</small>
    </label>
    <input id="initial_investment" v-model="initial_investment" type="number" pattern="/d*" min="1" value="100">
</div>
                <div>
    <label for="dividend_reinvestment">
        Reinvest Dividends
        <small>Whether dividends should be automatically reinvested into your portfolio allocations.</small>
    </label>
    <select id="dividend_reinvestment" v-model="dividend_reinvestment">
        <option value="yes" selected>Yes</option>
        <option value="no">No</option>
    </select>
</div>
                <div>
    <label for="start_date">
        Start Date
        <small>
            Start date for the simulation period. Ignored if the selected date is out of the range of available data.
        </small>
    </label>
    <input id="start_date" type="date" v-model="start_date" min="1970-01-01" value="1995-01-01">
</div>

<div>
    <label for="end_date">
        End Date
        <small>
            End date for the simulation period. Ignored if the selected date is out of the range of available data.
        </small>
    </label>
    <input id="end_date" type="date" v-model="end_date" min="1970-01-01" value="2022-01-01">
</div>
                <div>
    <label for="dca_schedule">
        Dollar-Cost Averaging Schedule
        <small>How often to simulate cash contributions to your portfolio.</small>
    </label>
    <select id="dca_schedule" v-model="dca_schedule">
        <option value="never" selected>Never</option>
        <option value="yearly">Yearly</option>
        <option value="quarterly">Quarterly</option>
        <option value="monthly">Monthly</option>
    </select>
</div>
<div v-show="dca_schedule !== 'never'">
    <label for="dca_amount">Dollar-Cost Averaging Amount</label>
    <br>
    <small>
        Amount of dollars being added to your portfolio at regular intervals.
    </small>
    <input id="dca_amount" v-model="dca_amount" type="number" pattern="/d+" min="0" value="0">
</div>
                <div>
    <label for="rebalance_schedule">
        Rebalancing Schedule
        <br>
        <small>
            How often to simulate portfolio rebalancing toward the original asset allocation.
        </small>
    </label>
    <select id="rebalance_schedule" v-model="rebalance_schedule">
        <option value="never">Never</option>
        <option value="yearly">Yearly</option>
        <option value="quarterly" selected>Quarterly</option>
        <option value="monthly">Monthly</option>
        <option value="daily">Daily</option>
    </select>
</div>

            </form>
        </details>

        <div class="spacer"></div>
    </div>

    <script async>function csv2json(e){return new Promise(t=>Papa.parse(e,{download:!0,complete:t})).then(e=>e.data).then(e=>e.slice(1).map(t=>e[0].reduce((e,a,r)=>Object.assign(e,{[a]:"Date"===a?t[r]:parseFloat(t[r])}),{})))}const rootElement=document.currentScript.parentElement,app=new Vue({el:"#portfolio-calculator-data",data:{error_message:null,symbols:["CASH","SPY","TLT","VTI","VXUS","VB","VBR","BND","UPRO","TMF"],target_allocations:"SPY:100",allocations_percent:{},initial_investment:1,rebalance_schedule:"yearly",schedules:["Never","Yearly","Quarterly","Monthly","Daily"],dividend_reinvestment:"yes",dca_schedule:"never",dca_amount:0,start_date:"1995-01-01",end_date:(new Date).toISOString().slice(0,10),performance:{"1 Year":{},"5 Year":{},"10 Year":{}},debouncer1:null,debouncer2:null,Formatter:Formatter},computed:{total_invested:function(){return Number(this.initial_investment)+this.dca_amount*this.performance.dca_count},final_balance:function(){return Number(this.initial_investment)+this.initial_investment*this.performance.returns},dca_ratio:function(){return this.dca_amount/this.initial_investment}},watch:{},methods:{alloc:function(){const e={};for(const[t,a]of Object.entries(this.allocations_percent))a>0&&(e[t]=a/100);return e},temp:function(){this.debouncer1&&clearTimeout(this.debouncer1),this.debouncer1=setTimeout(()=>{const e=this.allocations_percent;this.allocations_percent=null,this.allocations_percent=e},10)},meetsSchedule:function(e,t){const a=e=>1+Math.floor((Number(e)-1)/3),r=e=>e.toISOString().slice(0,10).split("-");if("never"===t||e.length<2)return!1;if("yearly"===t)return r(e.at(-1).date)[0]!==r(e.at(-2).date)[0];if("quarterly"===t)return a(r(e.at(-1).date)[1])!==a(r(e.at(-2).date)[1]);if("monthly"===t)return r(e.at(-1).date)[1]!==r(e.at(-2).date)[1];if("daily"===t)return!0;if(t.endsWith("% threshold")){const a=parseInt(t.split("%")[0])/100,r=this.alloc.map(t=>[t,e.at(-1)[t]]),n=r.reduce((e,[t,a])=>e+a,0);for(const[e,t]of r){const r=t/n,o=this.alloc[e];Math.abs(r-o);if(Math.abs(r-o)/o>a)return!0}return!1}throw new Error(`Unknown rebalancing strategy: ${t}`)},update:async function(e=!0){if(this.debouncer2&&clearTimeout(this.debouncer2),e)return void(this.debouncer2=setTimeout(()=>{this.update(!1)},500));this.error_message=null;const t=this.alloc();if(1!==Object.values(t).reduce((e,t)=>e+t,0))return void(this.error_message="Total allocations must be equal to 100%");await google.charts.load("current",{packages:["corechart"]});const a=Object.keys(t).sort((e,a)=>t[a]-t[e]),r="yes"===this.dividend_reinvestment,n=(await(r?this.daily_returns_reinvested:this.daily_returns)).filter(e=>e.Date.localeCompare(this.start_date)>=0).filter(e=>e.Date.localeCompare(this.end_date)<=0).filter(e=>a.every(t=>!isNaN(e[t])));if(!n||0===n.length)return void(this.error_message="No data found for the selected parameters. Try selecting a different date.");const o=[],s=[1,5,10].reduce((e,t)=>({...e,[t]:[]}),{}),i=Object.assign({total:1,total_minus_dca:1,max:1,dca_count:0,dca_total:0,rebalance_count:0},t);for(const e of n){i.total=a.reduce((e,t)=>e+i[t],0),i.total_minus_dca=i.total-i.dca_total,i.max=Math.max(i.max,i.total),i.drawdown=Math.min(0,(i.total-i.max)/i.max),a.forEach(t=>i[t]*=1+e[t]);const r=a.map(e=>i[e]).reduce((e,t)=>e+t,0);if(i.daily_returns=a.map(t=>e[t]*i[t]/r).reduce((e,t)=>e+t,0),o.push(Object.assign({date:new Date(e.Date)},i)),Object.keys(s).forEach(e=>{const t=Math.ceil(252.75*e);if(o.length>t){let a=1,r=0,n=0;for(const e of o.slice(-t))a*=1+e.daily_returns,n=Math.max(n,a),r=Math.min(r,(a-n)/n);s[e].push({returns:a-1,drawdown:r})}}),this.meetsSchedule(o,this.dca_schedule.toLowerCase())&&(i.dca_count++,i.dca_total+=this.dca_ratio,Object.entries(t).forEach(([e,t])=>i[e]+=this.dca_ratio/a.length)),this.meetsSchedule(o,this.rebalance_schedule.toLowerCase())){i.rebalance_count++;const e=a.reduce((e,t)=>e+i[t],0);Object.entries(t).forEach(([t,a])=>i[t]=e*a)}}this.performance={},Object.assign(this.performance,i),this.performance.returns=i.total-1,this.performance.returns_minus_dca=i.total_minus_dca-1,this.performance.start_date=o[0].date,this.performance.end_date=o.at(-1).date,this.performance.max_drawdown=Math.min(...o.map(e=>e.drawdown)),this.performance.returns_normalized=1;for(const e of o)this.performance.returns_normalized*=1+e.daily_returns;this.performance.returns_normalized-=1,this.performance.returns_annualized=this.performance.returns_minus_dca/(o.length/252.75),Object.keys(s).filter(e=>s[e].length>0).forEach(e=>{const t=e=>Math.round(1e3*e)/1e3,a=s[e].map(t=>t.returns/e),r=s[e].map(t=>t.drawdown/e),n=a.reduce((e,t)=>e+t,0),o=r.reduce((e,t)=>e+t,0),i=`${e} Year`;this.performance[i]={},this.performance[i].ret_avg=t(n/a.length),this.performance[i].ret_max=t(Math.max(...a)),this.performance[i].ret_min=t(Math.min(...a)),this.performance[i].drw_avg=t(o/r.length),this.performance[i].drw_max=t(Math.min(...r)),this.performance[i].drw_min=t(Math.max(...r))}),this.performance={...this.performance};const c=a.map(e=>`${this.allocations_percent[e]}% ${e}`).join(" · "),l=new google.visualization.DataTable;l.addColumn({label:"Date",type:"date"}),a.forEach(e=>l.addColumn({label:e,type:"number"})),l.addRows(o.map(e=>["date"].concat(a).map(t=>e[t])));const d=new google.visualization.DataTable;d.addColumn({label:"Date",type:"date"}),d.addColumn({label:"Drawdown",type:"number"}),d.addRows(o.map(e=>[e.date,e.drawdown]));const u=rootElement.querySelector("#perf-chart-container");new google.visualization.AreaChart(u).draw(l,Object.assign({},GOOGLE_CHARTS_CONFIG,{title:`${c} Performance`,curveType:"function",isStacked:!0,focusTarget:"category",colors:null,hAxis:{...GOOGLE_CHARTS_CONFIG.hAxis,format:"MM/yyyy",gridlines:{count:50}},vAxis:{...GOOGLE_CHARTS_CONFIG.vAxis,textPosition:"in"},interpolateNulls:!0,chartArea:{...GOOGLE_CHARTS_CONFIG.chartArea,left:0}}));const h=rootElement.querySelector("#drawdown-chart-container");new google.visualization.AreaChart(h).draw(d,Object.assign({},GOOGLE_CHARTS_CONFIG,{title:`${c} Drawdown`,curveType:"function",focusTarget:"category",colors:["red"],hAxis:{...GOOGLE_CHARTS_CONFIG.hAxis,format:"MM/yyyy",gridlines:{count:50}},vAxis:{...GOOGLE_CHARTS_CONFIG.vAxis,textPosition:"in",viewWindow:{max:0,min:-1}},interpolateNulls:!0,chartArea:{...GOOGLE_CHARTS_CONFIG.chartArea,left:0}})),u.style.backgroundImage="none"}}}),data=DataHelper.getQueryData(window.location);data.allocations_percent=data.target_allocations.split(",").reduce((e,t)=>{const[a,r]=t.split(":",2);return Object.assign(e,{[a]:parseInt(r)||0})},{}),Object.assign(app,data),app.symbols.forEach(e=>app.allocations_percent[e]=app.allocations_percent[e]||0);const urlBase="https://finmango.github.io/portfolio-simulator";app.daily_returns=csv2json(`${urlBase}/daily-returns.csv`),app.daily_returns_reinvested=csv2json(`${urlBase}/daily-returns-with-dividends-reinvested.csv`),Object.keys(data).concat(["dividend_reinvestment"]).forEach(e=>app.$watch(e,function(){this.update()},{deep:!0})),app.update();</script>
</div>
    </main>


</body></html>